let
	type rec = {a: int}
	var a := rec {a = 5}
	type arr = array of rec
	var arr := arr [2] of a

	function create_rec (): arr =
		 let
			var another_rec := rec {a = 6}
		 in
			arr[1] := another_rec;
			arr
		 end

	var b := create_rec ()
in
	printInt (arr[0].a);
	assert_equal_int("malloc.tig", arr[0].a, 5);
	
	printInt (b[1].a);
	assert_equal_int("malloc.tig", b[1].a, 6);

	arr[1].a := 5;
	assert_equal_int("malloc.tig", b[1].a, 5)
end
